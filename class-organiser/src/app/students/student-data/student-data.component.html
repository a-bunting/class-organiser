<div class="studentData">

    <div class="studentData__title">Student Data</div>

    <div class="studentData__import" *ngIf="loadedTimetable.students.length === 0">
        <div class="studentData__import--title">Import from CSV File</div>
        <div class="studentData__import--box">
            <div class="studentData__import--drop" (drop)="onDrop($event)" (dragover)="onDragOver($event)">Drop a CSV file here to import</div>
            <div class="studentData__import--instructions">
                <img src="../../../assets/howToCsv1.jpg" alt="How to CSV Step 1">
                <img src="../../../assets/howToCsv2.jpg" alt="How to CSV Step 2">
            </div>
        </div>
    </div>

    <table *ngIf="loadedTimetable">
        <thead *ngIf="loadedTimetable.students.length > 0">
            <tr>
                <th rowspan="2">Forename</th>
                <th rowspan="2">Surname</th>
                <th rowspan="2">Email</th>
                <th rowspan="2">Teacher</th>

                <th rowspan="2" *ngFor="let restriction of loadedTimetable.restrictions">
                    {{ restriction.name }}
                </th>

                <th rowspan="1" [attr.colspan]="getOptionalUnits().length">Course Priority</th>
            </tr>
            <tr>
                <th *ngFor="let course of getOptionalUnits(); let i = index">{{ i + 1 }}</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let student of  loadedTimetable.students">
                <td>{{ student.name.forename }}</td>
                <td>{{ student.name.surname }}</td>
                <td>{{ student?.email }}</td>
                <td>
                    <select class="input__select input__length--medium" (change)="modifyClassTeacher(student.id, $event)">
                        <option value="{{ class.id }}" *ngFor="let class of loadedTimetable.classes" [selected]="class.id === student.classId">{{ class.teacher }}</option>
                    </select>
                </td>
                <td *ngFor="let restriction of loadedTimetable.restrictions">
                    <select class="input__select input__length--medium" (change)="modifyDataValue(student, restriction.id, $event)">
                        <option value="{{ option.id }}" *ngFor="let option of restriction.options" [selected]="getStudentRestrictionData(student, restriction).id === option.id">{{ option.value }}</option>
                    </select>
                </td>
                <td *ngFor="let course of getOptionalUnits(); let priority = index">
                    <select class="input__select input__length--medium" (change)="changeCoursePriority(student, priority + 1, $event)">
                        <option value="{{ course.id }}" *ngFor="let course of getOptionalUnits(); let i = index" [selected]="getStudentPriorityData(student, priority + 1) === course.id">{{ course.name }}</option>
                    </select>
                    <!-- {{ getStudentPriorityData(student, course).name }} -->
                </td>
            </tr>
        </tbody>
    </table>
</div>
